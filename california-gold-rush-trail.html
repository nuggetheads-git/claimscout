<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>California Gold Rush Trail</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=IM+Fell+English+SC&family=IM+Fell+DW+Pica&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'IM Fell DW Pica', serif;
            background-color: #f4e9d8; /* Old paper color */
            background-image: url('https://www.transparenttextures.com/patterns/crissxcross.png');
        }
        .font-title {
            font-family: 'IM Fell English SC', serif;
        }
        .game-container {
            border: 4px solid #8c5a2b;
            box-shadow: 0 0 20px rgba(0,0,0,0.5);
            background-color: #faf0e6;
        }
        .map-path-segment {
            transition: background-color 0.5s ease;
        }
        .player-marker {
            transition: left 0.5s ease-in-out;
            width: 40px;
            height: 40px;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><text y=".9em" font-size="90">ðŸ¤ </text></svg>');
            background-size: contain;
        }
        .btn-action {
            border: 2px solid #8c5a2b;
            background-color: #c8a079;
            transition: all 0.2s ease;
            box-shadow: 2px 2px 5px rgba(0,0,0,0.3);
        }
        .btn-action:hover {
            background-color: #a5815c;
            transform: translateY(-2px);
            box-shadow: 4px 4px 8px rgba(0,0,0,0.3);
        }
        .btn-action:disabled {
            background-color: #d1c7bc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .event-log {
            border: 2px solid #c8a079;
            background-color: #fffaf0;
            height: 150px;
            overflow-y: auto;
        }
        .modal-backdrop {
            background-color: rgba(0,0,0,0.6);
        }
        .modal-content {
            background-color: #faf0e6;
            border: 4px solid #8c5a2b;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen p-4">

    <div id="game-container" class="game-container w-full max-w-4xl mx-auto p-6 rounded-lg">
        <!-- Game Title -->
        <h1 class="font-title text-4xl text-center text-amber-900 mb-4">California Gold Rush Trail</h1>
        
        <!-- Game Stats -->
        <div class="grid grid-cols-2 md:grid-cols-5 gap-4 mb-6 text-center">
            <div class="bg-amber-100 p-2 rounded-lg border border-amber-300">
                <h2 class="font-title text-lg">Health</h2>
                <p id="health-stat" class="text-2xl font-bold text-red-700">100</p>
            </div>
            <div class="bg-amber-100 p-2 rounded-lg border border-amber-300">
                <h2 class="font-title text-lg">Food</h2>
                <p id="food-stat" class="text-2xl font-bold text-green-700">10</p>
            </div>
            <div class="bg-amber-100 p-2 rounded-lg border border-amber-300">
                <h2 class="font-title text-lg">Water</h2>
                <p id="water-stat" class="text-2xl font-bold text-blue-700">10</p>
            </div>
            <div class="bg-amber-100 p-2 rounded-lg border border-amber-300">
                <h2 class="font-title text-lg">Gold</h2>
                <p id="gold-stat" class="text-2xl font-bold text-yellow-600">0</p>
            </div>
             <div class="bg-amber-100 p-2 rounded-lg border border-amber-300 col-span-2 md:col-span-1">
                <h2 class="font-title text-lg">Progress</h2>
                <p id="progress-stat" class="text-2xl font-bold text-amber-800">0 / 20</p>
            </div>
        </div>

        <!-- Map -->
        <div class="mb-6">
            <h2 class="font-title text-2xl text-amber-800 mb-2">The Trail to California</h2>
            <div class="bg-stone-300 p-4 rounded-lg relative h-24 border-2 border-stone-400">
                <div class="absolute top-1/2 -translate-y-1/2 left-0 right-0 h-2 bg-stone-500"></div>
                <div id="map-path" class="absolute top-1/2 -translate-y-1/2 left-0 right-0 h-2 flex">
                    <!-- Path segments will be generated by JS -->
                </div>
                <div id="player-marker" class="player-marker absolute top-1/2 -translate-y-1/2" style="left: 2.5%;"></div>
                <span class="absolute -bottom-1 left-0 text-xs">Missouri</span>
                <span class="absolute -bottom-1 right-0 text-xs">California</span>
            </div>
        </div>

        <!-- Event Log -->
        <div class="mb-6">
            <h2 class="font-title text-2xl text-amber-800 mb-2">Prospector's Diary</h2>
            <div id="event-log" class="event-log p-3 rounded-lg text-amber-900">
                Welcome, prospector! Your journey to California begins. Good luck!
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex justify-center space-x-4">
            <button id="travel-btn" class="btn-action font-title text-xl px-6 py-3 rounded-lg">Travel West</button>
            <button id="rest-btn" class="btn-action font-title text-xl px-6 py-3 rounded-lg">Make Camp</button>
            <button id="forage-btn" class="btn-action font-title text-xl px-6 py-3 rounded-lg">Forage</button>
        </div>
    </div>

    <!-- Modal for Game Over/Win -->
    <div id="modal" class="hidden fixed inset-0 modal-backdrop flex items-center justify-center z-50 p-4">
        <div class="modal-content max-w-md w-full p-8 rounded-lg text-center">
            <h2 id="modal-title" class="font-title text-4xl text-amber-900 mb-4"></h2>
            <p id="modal-text" class="text-lg text-amber-800 mb-6"></p>
            <button id="restart-btn" class="btn-action font-title text-xl px-8 py-3 rounded-lg">Start Anew</button>
        </div>
    </div>

    <script>
        // Game State
        let gameState = {};

        const TOTAL_STEPS = 20;

        // UI Elements
        const healthStat = document.getElementById('health-stat');
        const foodStat = document.getElementById('food-stat');
        const waterStat = document.getElementById('water-stat');
        const goldStat = document.getElementById('gold-stat');
        const progressStat = document.getElementById('progress-stat');
        const playerMarker = document.getElementById('player-marker');
        const mapPath = document.getElementById('map-path');
        const eventLog = document.getElementById('event-log');
        const travelBtn = document.getElementById('travel-btn');
        const restBtn = document.getElementById('rest-btn');
        const forageBtn = document.getElementById('forage-btn');
        const modal = document.getElementById('modal');
        const modalTitle = document.getElementById('modal-title');
        const modalText = document.getElementById('modal-text');
        const restartBtn = document.getElementById('restart-btn');

        // Game Events Database
        const events = [
            { type: 'positive', text: "You find a sparkling creek. Water +5.", effect: () => { gameState.water += 5; }},
            { type: 'positive', text: "You stumble upon an abandoned wagon with leftover supplies. Food +5.", effect: () => { gameState.food += 5; }},
            { type: 'positive', text: "You pan a stream and find a small gold nugget! Gold +10.", effect: () => { gameState.gold += 10; }},
            { type: 'positive', text: "A friendly Native American tribe shares some jerky with you. Food +3.", effect: () => { gameState.food += 3; }},
            { type: 'positive', text: "The weather is perfect. You feel rejuvenated. Health +10.", effect: () => { gameState.health = Math.min(100, gameState.health + 10); }},
            
            { type: 'negative', text: "Bandits ambush you! They steal some of your gold.", effect: () => { const loss = Math.min(gameState.gold, 15); gameState.gold -= loss; return `You lost ${loss} gold.`; }},
            { type: 'negative', text: "You come down with dysentery. Health -20.", effect: () => { gameState.health -= 20; }},
            { type: 'negative', text: "Your water barrel springs a leak. Water -4.", effect: () => { gameState.water = Math.max(0, gameState.water - 4); }},
            { type: 'negative', text: "A terrible storm forces you to take shelter, consuming extra supplies. Food -2, Water -2.", effect: () => { gameState.food = Math.max(0, gameState.food - 2); gameState.water = Math.max(0, gameState.water - 2); }},
            { type: 'negative', text: "You cross a treacherous mountain pass. It takes a toll on your body. Health -15.", effect: () => { gameState.health -= 15; }},
            { type: 'negative', text: "Your wagon wheel is broken! You lose time and food repairing it. Food -3.", effect: () => { gameState.food = Math.max(0, gameState.food - 3); }},
            
            { type: 'neutral', text: "You spend a quiet day on the trail. The vast plains are a sight to behold.", effect: () => {} },
            { type: 'neutral', text: "You meet another prospector heading west. You trade stories by the campfire.", effect: () => {} },
        ];

        // --- GAME LOGIC ---

        function initializeGame() {
            gameState = {
                health: 100,
                food: 10,
                water: 10,
                gold: 0,
                progress: 0,
                isGameOver: false,
            };
            
            // Create map path segments
            mapPath.innerHTML = '';
            for (let i = 0; i < TOTAL_STEPS; i++) {
                const segment = document.createElement('div');
                segment.classList.add('map-path-segment', 'flex-1', 'h-full');
                segment.style.backgroundColor = 'transparent';
                mapPath.appendChild(segment);
            }

            modal.classList.add('hidden');
            logEvent("Your journey to California begins. Good luck!");
            updateUI();
        }

        function updateUI() {
            healthStat.textContent = gameState.health;
            foodStat.textContent = gameState.food;
            waterStat.textContent = gameState.water;
            goldStat.textContent = gameState.gold;
            progressStat.textContent = `${gameState.progress} / ${TOTAL_STEPS}`;

            // Update player marker position
            const progressPercentage = (gameState.progress / TOTAL_STEPS) * 95 + 2.5; // 2.5% offset
            playerMarker.style.left = `${progressPercentage}%`;
            
            // Update map path color
            const pathSegments = mapPath.children;
            for (let i = 0; i < TOTAL_STEPS; i++) {
                if (i < gameState.progress) {
                    pathSegments[i].style.backgroundColor = '#8c5a2b'; // Visited path
                } else {
                    pathSegments[i].style.backgroundColor = 'transparent';
                }
            }

            // Disable buttons if game is over
            travelBtn.disabled = gameState.isGameOver;
            restBtn.disabled = gameState.isGameOver;
            forageBtn.disabled = gameState.isGameOver;
        }

        function logEvent(message) {
            const p = document.createElement('p');
            p.textContent = `> ${message}`;
            eventLog.appendChild(p);
            eventLog.scrollTop = eventLog.scrollHeight; // Auto-scroll to bottom
        }

        function triggerRandomEvent() {
            const event = events[Math.floor(Math.random() * events.length)];
            let message = event.text;
            const effectMessage = event.effect();
            if (effectMessage) {
                message += ` ${effectMessage}`;
            }
            logEvent(message);
        }

        function checkGameState() {
            if (gameState.isGameOver) return;

            if (gameState.health <= 0) {
                endGame(false, "Your health has failed you. The trail has claimed another soul.");
            } else if (gameState.food <= 0) {
                logEvent("You have run out of food! You are losing health from starvation.");
                gameState.health -= 10;
            } else if (gameState.water <= 0) {
                logEvent("You have run out of water! You are losing health from dehydration.");
                gameState.health -= 15;
            }

            if (gameState.health <= 0 && !gameState.isGameOver) {
                 endGame(false, "You have succumbed to the harshness of the trail.");
            }
            
            updateUI();
        }

        function endGame(isWin, message) {
            gameState.isGameOver = true;
            updateUI();
            
            if (isWin) {
                modalTitle.textContent = "Congratulations!";
                modalText.textContent = `You've made it to California! You arrived with ${gameState.gold} gold. Time to start prospecting!`;
            } else {
                modalTitle.textContent = "Game Over";
                modalText.textContent = message;
            }
            modal.classList.remove('hidden');
        }

        // --- PLAYER ACTIONS ---

        function travel() {
            if (gameState.isGameOver) return;

            if (gameState.food > 0 && gameState.water > 0) {
                gameState.progress++;
                gameState.food--;
                gameState.water--;
                logEvent(`You travel west, one day closer to your dream. (Food -1, Water -1)`);
                
                if (gameState.progress >= TOTAL_STEPS) {
                    endGame(true);
                } else {
                    triggerRandomEvent();
                }

            } else {
                logEvent("You are too hungry or thirsty to travel.");
            }
            checkGameState();
        }

        function rest() {
            if (gameState.isGameOver) return;

            if (gameState.food > 0) {
                gameState.food--;
                const healthGained = Math.min(20, 100 - gameState.health); // Can't go over 100
                gameState.health += healthGained;
                logEvent(`You make camp for the day and rest your weary body. (Food -1, Health +${healthGained})`);
            } else {
                logEvent("You need food to be able to rest effectively.");
            }
            checkGameState();
        }

        function forage() {
            if (gameState.isGameOver) return;

            const roll = Math.random();
            if (roll > 0.6) { // 40% chance of success
                const foundFood = Math.floor(Math.random() * 3) + 1;
                const foundWater = Math.floor(Math.random() * 3) + 1;
                gameState.food += foundFood;
                gameState.water += foundWater;
                logEvent(`Your search is fruitful! You find berries and a clean spring. (Food +${foundFood}, Water +${foundWater})`);
            } else if (roll > 0.2) { // 40% chance of nothing
                 logEvent("You search for hours but find nothing of use.");
            } else { // 20% chance of negative event
                logEvent("While foraging, you get bitten by a snake! Health -10.");
                gameState.health -= 10;
            }
            checkGameState();
        }

        // --- EVENT LISTENERS ---
        travelBtn.addEventListener('click', travel);
        restBtn.addEventListener('click', rest);
        forageBtn.addEventListener('click', forage);
        restartBtn.addEventListener('click', initializeGame);

        // --- INITIALIZE ---
        window.onload = initializeGame;
    </script>
</body>
</html>
